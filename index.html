<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Hidros | Archivio Volley</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script src="partite.js"></script>
    <script src="highlights.js"></script>
    <script src="shorts.js"></script>

    <style>
        body { margin: 0; padding: 0; background-color: #000; color: #fff; font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif; overflow-x: hidden; }

        /* --- SIDEBAR --- */
        .sidebar { 
            height: 100vh; width: 0; position: fixed; z-index: 600; top: 0; left: 0; 
            background-color: #111; overflow-x: hidden; overflow-y: scroll; transition: 0.3s; 
            padding-top: 60px; display: flex; flex-direction: column;
        }
        .sidebar::after { content: ""; min-height: 150px; display: block; width: 100%; }
        .sidebar::-webkit-scrollbar { width: 8px; }
        .sidebar::-webkit-scrollbar-thumb { background: #a855f7; border-radius: 10px; }
        .sidebar::-webkit-scrollbar-track { background: #111; }
        .sidebar a, .dropdown-btn { padding: 15px 25px; text-decoration: none; font-size: 18px; color: #ccc; display: block; border: none; background: none; width: 100%; text-align: left; cursor: pointer; outline: none; font-family: inherit; flex-shrink: 0; }
        .sidebar .closebtn { position: absolute; top: 10px; right: 25px; font-size: 36px; z-index: 610; }
        .dropdown-container { display: none; background-color: #1a1a1a; }
        .sub-container { background-color: #222 !important; padding-left: 20px; }
        .caret { font-size: 12px; float: right; margin-top: 5px; }

        /* --- HEADER --- */
        .header { display: flex; justify-content: space-between; align-items: center; padding: 12px 15px; background-color: #1c1c1c; position: sticky; top: 0; z-index: 100; }
        .header-left { display: flex; align-items: center; gap: 15px; }
        .menu-icon { font-size: 24px; cursor: pointer; }
        .logo { font-weight: 800; font-size: 20px; color: #a855f7; text-transform: uppercase; cursor: pointer; }
        .icons img { height: 22px; vertical-align: middle; margin-left: 15px; cursor: pointer; }

        /* --- RICERCA --- */
        #search-bar-container { display: none; padding: 15px; background: #1c1c1c; }
        #search-input { width: 100%; padding: 12px; border-radius: 8px; border: none; background: #333; color: #fff; font-size: 16px; box-sizing: border-box; }
        #search-results { background: #000; }
        .search-result-item { display: flex; align-items: center; padding: 10px; border-bottom: 1px solid #222; gap: 15px; cursor: pointer; }
        .search-thumb { width: 100px; aspect-ratio: 16/9; border-radius: 5px; object-fit: cover; }
        .search-info b { font-size: 14px; color: #fff; }

        /* --- GRID STILE SHORTS --- */
        .insta-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 2px; padding: 2px; }
        .insta-item { aspect-ratio: 9/16; position: relative; overflow: hidden; cursor: pointer; }
        .insta-item img { width: 100%; height: 100%; object-fit: cover; }
        .insta-badge { position: absolute; bottom: 5px; left: 5px; background: rgba(168, 85, 247, 0.9); color: white; font-size: 9px; padding: 2px 5px; border-radius: 4px; font-weight: bold; }

        /* --- PLAYER PAGE --- */
        #player-page { background-color: #000; z-index: 700; position: fixed; top: 0; left: 0; width: 100%; height: 100%; overflow-y: auto; display: none; }
        .player-cover { width: 100%; aspect-ratio: 16/9; object-fit: cover; }
        .player-content { padding: 5px 20px 40px; margin-top: -15px; }
        .p-cat-tag { background: #a855f7; display: inline-block; padding: 5px 12px; border-radius: 6px; font-weight: bold; font-size: 14px; margin-bottom: 15px; }
        .player-title { font-size: 38px; font-weight: 900; line-height: 1.1; margin-bottom: 15px; }
        .player-score { font-size: 50px; font-weight: 900; color: #a855f7; margin-bottom: 5px; letter-spacing: -2px; }
        .player-date { font-size: 22px; color: #888; margin-bottom: 30px; font-weight: 600; }
        .watch-btn { width: 100%; background: #fff; color: #000; border: none; padding: 18px; border-radius: 15px; font-size: 20px; font-weight: 800; cursor: pointer; }
        .back-btn-player { position: absolute; top: 20px; left: 20px; background: rgba(255, 255, 255, 0.2); backdrop-filter: blur(10px); color: white; border: 1px solid rgba(255,255,255,0.3); padding: 8px 15px; border-radius: 8px; font-size: 14px; font-weight: bold; z-index: 710; cursor: pointer; }

        .page { display: none; min-height: 100vh; padding-bottom: 50px; }
        .active-page { display: block; }
        .section-title { padding: 20px 15px 5px; font-size: 22px; font-weight: bold; display: flex; justify-content: space-between; align-items: center; }

        .horizontal-scroll { display: flex; overflow-x: auto; padding: 10px 15px 25px; gap: 20px; -webkit-overflow-scrolling: touch; scrollbar-width: thin; scrollbar-color: #a855f7 #1c1c1c; }
        .horizontal-scroll::-webkit-scrollbar { height: 6px; }
        .horizontal-scroll::-webkit-scrollbar-track { background: #1c1c1c; border-radius: 10px; margin: 0 15px; }
        .horizontal-scroll::-webkit-scrollbar-thumb { background: #a855f7; border-radius: 10px; }

        .card { min-width: 240px; cursor: pointer; position: relative; }
        .thumbnail-container { position: relative; width: 100%; aspect-ratio: 16/9; border-radius: 15px; overflow: hidden; background: #1c1c1c; }
        .thumbnail-container img { width: 100%; height: 100%; object-fit: cover; }
        .info-badge { position: absolute; top: 10px; left: 10px; background: rgba(0,0,0,0.7); padding: 4px 8px; border-radius: 5px; font-size: 10px; font-weight: bold; border: 1px solid #a855f7; z-index: 10; }
        .save-badge { position: absolute; top: 10px; right: 10px; background: #a855f7; padding: 6px 12px; border-radius: 8px; font-size: 11px; font-weight: bold; z-index: 10; }
        .card-title { margin-top: 12px; font-size: 16px; font-weight: 700; }

        .history-grid, .saved-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; padding: 15px; }
        .history-grid .card, .saved-grid .card { min-width: unset; }

        .slider-container { position: relative; width: 100%; height: 350px; overflow: hidden; }
        .slider { display: flex; width: 100%; height: 100%; transition: transform 0.6s cubic-bezier(0.4, 0, 0.2, 1); }
        .slide { min-width: 100%; height: 100%; position: relative; background-size: cover; background-position: center; cursor: pointer; }
        .slide-info { position: absolute; bottom: 0; left: 0; right: 0; padding: 60px 20px 30px; background: linear-gradient(to top, #000, transparent); }
        .progress-container { position: absolute; bottom: 0; width: 100%; height: 4px; background: rgba(255,255,255,0.1); }
        .progress-bar { height: 100%; width: 0; background: #a855f7; }

        .empty-message { display: flex; flex-direction: column; align-items: center; justify-content: center; text-align: center; color: #555; height: 70vh; padding: 20px; }
        .empty-message h2 { font-size: 30px; color: #888; margin-bottom: 10px; }
        .home-btn { background: #a855f7; color: white; border: none; padding: 12px 30px; border-radius: 30px; font-weight: bold; font-size: 16px; cursor: pointer; margin-top: 20px; }
        .clear-btn { display: block; width: 80%; margin: 30px auto; background: none; border: 1px solid #444; color: #888; padding: 12px; border-radius: 10px; font-weight: bold; }
    </style>
</head>
<body>

    <div id="mySidebar" class="sidebar">
        <a href="javascript:void(0)" class="closebtn" onclick="closeNav()">Ã—</a>
        <div style="padding: 0 25px 20px; font-weight: bold; color: #a855f7; font-size: 24px; flex-shrink: 0;">HIDROS</div>
        <a href="#" onclick="showPage('home')"><img src="PNG/HomeMenu.png" style="width: 20px; vertical-align: middle; margin-right: 10px;"> Home</a>
        <a href="#" onclick="openHighlights()"><img src="PNG/Trofeo.png" style="width: 20px; vertical-align: middle; margin-right: 10px;"> Highlights</a>
        <a href="#" onclick="openShorts()"><img src="PNG/Trofeo.png" style="width: 20px; vertical-align: middle; margin-right: 10px;"> Shorts</a>
        <button class="dropdown-btn" onclick="toggleDropdown('tournaments')"> <img src="PNG/Trofeo.png" style="width: 20px; vertical-align: middle; margin-right: 10px;"> Tutti i Tornei <span class="caret">â–¼</span></button>
        <div class="dropdown-container" id="tournaments">
            <button class="dropdown-btn" onclick="toggleDropdown('u14')">Under 14 <span class="caret">â–¼</span></button>
            <div class="dropdown-container sub-container" id="u14"><a href="#" onclick="openCategory('Under 14')">ðŸ“… 25-26</a></div>
            <button class="dropdown-btn" onclick="toggleDropdown('u15')">Under 15 <span class="caret">â–¼</span></button>
            <div class="dropdown-container sub-container" id="u15"><a href="#" onclick="openCategory('Under 15')">ðŸ“… 25-26</a></div>
            <button class="dropdown-btn" onclick="toggleDropdown('u16')">Under 16 <span class="caret">â–¼</span></button>
            <div class="dropdown-container sub-container" id="u16"><a href="#" onclick="openCategory('Under 16')">ðŸ“… 25-26</a></div>
            <button class="dropdown-btn" onclick="toggleDropdown('u17')">Under 17 <span class="caret">â–¼</span></button>
            <div class="dropdown-container sub-container" id="u17"><a href="#" onclick="openCategory('Under 17')">ðŸ“… 25-26</a></div>
            <button class="dropdown-btn" onclick="toggleDropdown('u18')">Under 18 <span class="caret">â–¼</span></button>
            <div class="dropdown-container sub-container" id="u18"><a href="#" onclick="openCategory('Under 18')">ðŸ“… 25-26</a></div>
            <button class="dropdown-btn" onclick="toggleDropdown('u19')">Under 19 <span class="caret">â–¼</span></button>
            <div class="dropdown-container sub-container" id="u19"><a href="#" onclick="openCategory('Under 19')">ðŸ“… 25-26</a></div>
            <button class="dropdown-btn" onclick="toggleDropdown('pdiv')">Prima Divisione <span class="caret">â–¼</span></button>
            <div class="dropdown-container sub-container" id="pdiv"><a href="#" onclick="openCategory('Prima Divisione')">ðŸ“… 25-26</a></div>
            <button class="dropdown-btn" onclick="toggleDropdown('seried')">Serie D <span class="caret">â–¼</span></button>
            <div class="dropdown-container sub-container" id="seried"><a href="#" onclick="openCategory('Serie D')">ðŸ“… 25-26</a></div>
            <button class="dropdown-btn" onclick="toggleDropdown('seriec')">Serie C <span class="caret">â–¼</span></button>
            <div class="dropdown-container sub-container" id="seriec"><a href="#" onclick="openCategory('Serie C')">ðŸ“… 25-26</a></div>
        </div>
    </div>

    <div class="header">
        <div class="header-left"><div class="menu-icon" onclick="openNav()">â˜°</div><div class="logo" onclick="showPage('home')">Hidros</div></div>
        <div class="icons">
            <img src="PNG/LenteDiIngrandimento.png" onclick="toggleSearch()">
            <img src="PNG/Cronologia.png" onclick="showHistoryPage()">
            <img src="PNG/SegnaLibro.png" onclick="showSavedPage()">
        </div>
    </div>

    <div id="search-bar-container">
        <input type="text" id="search-input" placeholder="Cerca partita Hidros..." oninput="handleSearch(this.value)">
        <div id="search-results"></div>
    </div>

    <div id="home" class="page active-page">
        <div class="section-title">Partite da non perdere</div>
        <div class="slider-container">
            <div class="slider" id="homeSlider"></div>
            <div class="progress-container"><div class="progress-bar" id="homeProgressBar"></div></div>
        </div>
        <div class="section-title">Ultime Sfide Hidros</div>
        <div class="horizontal-scroll" id="latest-matches"></div>
    </div>

    <div id="highlights-page" class="page">
        <div class="section-title">Highlights in evidenza</div>
        <div class="slider-container">
            <div class="slider" id="highSlider"></div>
            <div class="progress-container"><div class="progress-bar" id="highProgressBar"></div></div>
        </div>
        <div class="section-title">Tutti gli Highlights</div>
        <div class="horizontal-scroll" id="high-list"></div>
    </div>

    <div id="shorts-page" class="page">
        <div class="section-title">Hidros Shorts</div>
        <div class="insta-grid" id="shorts-grid"></div>
    </div>

    <div id="category-page" class="page">
        <div class="section-title">Partite da non perdere</div>
        <div class="slider-container">
            <div class="slider" id="catSlider"></div>
            <div class="progress-container"><div class="progress-bar" id="catProgressBar"></div></div>
        </div>
        <div class="section-title" id="cat-all-title">Tutte le partite</div>
        <div class="horizontal-scroll" id="cat-all-list"></div>
    </div>

    <div id="history-page" class="page">
        <div id="history-content"></div>
    </div>

    <div id="saved-page" class="page">
        <div id="saved-content"></div>
    </div>

    <div id="player-page">
        <button class="back-btn-player" onclick="closePlayer()">TORNA INDIETRO</button>
        <img id="p-img" class="player-cover" src="">
        <div class="player-content">
            <div id="p-cat" class="p-cat-tag">CATEGORIA</div>
            <div id="p-title" class="player-title">Titolo</div>
            <div id="p-score" class="player-score">0 - 0</div>
            <div id="p-date" class="player-date">Data</div>
            <button class="watch-btn" onclick="startVideo()">GUARDA IL MATCH</button>
        </div>
    </div>

    <script>
        const tg = window.Telegram.WebApp;
        tg.expand();

        let currentMatchId = '';
        let sliders = { home: { idx: 0, start: Date.now() }, cat: { idx: 0, start: Date.now() }, high: { idx: 0, start: Date.now() } };

        function initApp() {
            const sliderHome = document.getElementById('homeSlider');
            if(sliderHome) {
                const homeSlides = DB_PARTITE.filter(p => p.sliderHome === 'si');
                sliderHome.innerHTML = homeSlides.map(p => `
                    <div class="slide" style="background-image: url('${p.img}');" onclick="openMatch('${p.id}', 'partite')">
                        <div class="slide-info">
                            <div class="p-cat-tag">${p.tag || 'MATCH'}</div>
                            <div class="slide-title">${p.titolo}</div>
                        </div>
                    </div>
                `).join('');
            }
            const latestList = document.getElementById('latest-matches');
            if(latestList) {
                const homeRecentMatches = DB_PARTITE.filter(p => p.HomeRecenti === 'si');
                latestList.innerHTML = homeRecentMatches.map(p => `
                    <div class="card" onclick="openMatch('${p.id}', 'partite')">
                        <div class="thumbnail-container">
                            <img src="${p.img}">
                            <div class="info-badge">${p.tag || 'MATCH'}</div>
                            <div class="save-badge" onclick="event.stopPropagation(); saveContent('${p.id}', 'partite')">SALVA</div>
                        </div>
                        <div class="card-title">${p.titolo}</div>
                    </div>
                `).join('');
            }
        }

        function openHighlights() {
            showPage('highlights-page');
            const highSlides = DB_HIGHLIGHTS.filter(p => p.slider === 'si');
            document.getElementById('highSlider').innerHTML = highSlides.map(p => `
                <div class="slide" style="background-image: url('${p.img}');" onclick="openMatch('${p.id}', 'highlights')">
                    <div class="slide-info">
                        <div class="p-cat-tag">${p.cat}</div>
                        <div class="slide-title">${p.titolo}</div>
                    </div>
                </div>`).join('');

            document.getElementById('high-list').innerHTML = DB_HIGHLIGHTS.map(p => `
                <div class="card" onclick="openMatch('${p.id}', 'highlights')">
                    <div class="thumbnail-container">
                        <img src="${p.img}">
                        <div class="info-badge">${p.cat}</div>
                        <div class="save-badge" onclick="event.stopPropagation(); saveContent('${p.id}', 'highlights')">SALVA</div>
                    </div>
                    <div class="card-title">${p.titolo}</div>
                </div>`).join('');
            sliders.high.start = Date.now();
        }

        function openCategory(nome) {
            showPage('category-page');
            document.getElementById('cat-all-title').innerText = "Tutte le partite " + nome;
            const catMatches = DB_PARTITE.filter(p => p.cat === nome);
            const catSlides = catMatches.filter(p => p.sliderCat === 'si');
            const slider = document.getElementById('catSlider');
            if(catSlides.length > 0) {
                slider.innerHTML = catSlides.map(p => `
                <div class="slide" style="background-image: url('${p.img}');" onclick="openMatch('${p.id}', 'partite')">
                    <div class="slide-info">
                        <div class="p-cat-tag">${p.tag || 'IN EVIDENZA'}</div>
                        <div class="slide-title">${p.titolo}</div>
                    </div>
                </div>`).join('');
            } else { slider.innerHTML = `<div class="slide"><div class="slide-info"><div class="slide-title">Nessun match in evidenza per ${nome}</div></div></div>`; }

            document.getElementById('cat-all-list').innerHTML = catMatches.map(p => `
                <div class="card" onclick="openMatch('${p.id}', 'partite')">
                    <div class="thumbnail-container">
                        <img src="${p.img}">
                        <div class="info-badge">${p.tag || 'MATCH'}</div>
                        <div class="save-badge" onclick="event.stopPropagation(); saveContent('${p.id}', 'partite')">SALVA</div>
                    </div>
                    <div class="card-title">${p.titolo}</div>
                </div>
            `).join('');
        }

        function openShorts() {
            showPage('shorts-page');
            document.getElementById('shorts-grid').innerHTML = DB_SHORTS.map(p => `
                <div class="insta-item" onclick="openMatch('${p.id}', 'shorts')">
                    <img src="${p.img}">
                    <div class="insta-badge">${p.cat}</div>
                    <div class="save-badge" style="font-size:8px; padding:3px 6px;" onclick="event.stopPropagation(); saveContent('${p.id}', 'shorts')">SALVA</div>
                </div>`).join('');
        }

        function openMatch(id, dbType = 'partite') {
            let db = DB_PARTITE;
            if(dbType === 'highlights') db = DB_HIGHLIGHTS;
            if(dbType === 'shorts') db = DB_SHORTS;

            const match = db.find(p => p.id === id);
            if(!match) return;

            const watchBtn = document.querySelector('.watch-btn');
            if (dbType === 'highlights') { watchBtn.innerText = "GUARDA HIGHLIGHTS"; } 
            else if (dbType === 'shorts') { watchBtn.innerText = "GUARDA SHORTS"; } 
            else { watchBtn.innerText = "GUARDA IL MATCH"; }

            document.getElementById('p-img').src = match.img;
            document.getElementById('p-title').innerText = match.titolo;
            document.getElementById('p-score').innerText = match.punteggio || "";
            document.getElementById('p-cat').innerText = (match.cat || "").toUpperCase();
            document.getElementById('p-date').innerText = match.anno;
            document.getElementById('player-page').style.display = 'block';
            document.body.style.overflow = 'hidden';
            currentMatchId = id;
            currentMatchId_type = dbType; // Salviamo il tipo per la cronologia
        }

        function closePlayer() { document.getElementById('player-page').style.display = 'none'; document.body.style.overflow = 'auto'; }

        function startVideo() { 
            const allDbs = [...DB_PARTITE, ...DB_HIGHLIGHTS, ...DB_SHORTS];
            const match = allDbs.find(p => p.id === currentMatchId);
            if(match) {
                let type = 'partite';
                if(DB_HIGHLIGHTS.find(x => x.id === match.id)) type = 'highlights';
                if(DB_SHORTS.find(x => x.id === match.id)) type = 'shorts';
                addToHistory(match, type); 
            }
            tg.sendData(currentMatchId); 
            tg.HapticFeedback.impactOccurred('heavy');
            setTimeout(() => { tg.close(); }, 150); 
        }

        function showPage(pageId) {
            closePlayer(); closeNav();
            document.getElementById('search-bar-container').style.display = 'none';
            document.querySelectorAll('.page').forEach(p => p.classList.remove('active-page'));
            const target = document.getElementById(pageId);
            if(target) target.classList.add('active-page');
            window.scrollTo(0,0);
        }

        // --- SALVATAGGIO UNIVERSALE ---
        function saveContent(id, type) {
            let db = type === 'partite' ? DB_PARTITE : (type === 'highlights' ? DB_HIGHLIGHTS : DB_SHORTS);
            let item = db.find(x => x.id === id);
            if(!item) return;

            let saved = JSON.parse(localStorage.getItem('hidros_saved_v2') || '[]');
            if (!saved.find(m => m.id === id)) {
                saved.push({id: item.id, titolo: item.titolo, img: item.img, type: type});
                localStorage.setItem('hidros_saved_v2', JSON.stringify(saved));
                tg.HapticFeedback.notificationOccurred('success');
            }
        }

        function addToHistory(match, type) {
            let history = JSON.parse(localStorage.getItem('hidros_history_v2') || '[]');
            history = history.filter(m => m.id !== match.id);
            history.unshift({id: match.id, titolo: match.titolo, img: match.img, type: type});
            localStorage.setItem('hidros_history_v2', JSON.stringify(history.slice(0, 20)));
        }

        function showHistoryPage() {
            showPage('history-page');
            const history = JSON.parse(localStorage.getItem('hidros_history_v2') || '[]');
            const container = document.getElementById('history-content');
            if (history.length === 0) {
                container.innerHTML = `<div class="empty-message"><h2>Cronologia vuota</h2><button class="home-btn" onclick="showPage('home')">Inizia a guardare</button></div>`;
            } else {
                let html = `<div class="section-title">Visti di recente</div><div class="history-grid">`;
                history.forEach(m => { html += `<div class="card" onclick="openMatch('${m.id}', '${m.type}')"><div class="thumbnail-container"><img src="${m.img}"></div><div class="card-title">${m.titolo}</div></div>`; });
                html += `</div><button class="clear-btn" onclick="localStorage.removeItem('hidros_history_v2'); showHistoryPage();">Cancella cronologia</button>`;
                container.innerHTML = html;
            }
        }

        function showSavedPage() {
            showPage('saved-page');
            const saved = JSON.parse(localStorage.getItem('hidros_saved_v2') || '[]');
            const container = document.getElementById('saved-content');
            if (saved.length === 0) {
                container.innerHTML = `<div class="empty-message"><h2>Nessun salvataggio</h2><button class="home-btn" onclick="showPage('home')">Torna alla Home</button></div>`;
            } else {
                let html = `<div class="section-title">I tuoi Segnalibri</div><div class="saved-grid">`;
                saved.forEach(m => { html += `<div class="card" onclick="openMatch('${m.id}', '${m.type}')"><div class="thumbnail-container"><img src="${m.img}"></div><div class="card-title">${m.titolo}</div></div>`; });
                html += `</div><button class="clear-btn" onclick="localStorage.removeItem('hidros_saved_v2'); showSavedPage();">Svuota tutto</button>`;
                container.innerHTML = html;
            }
        }

        function handleSearch(val) {
            const res = document.getElementById('search-results');
            if(!val) { res.innerHTML = ''; return; }
            const allDbsWithTypes = [
                ...DB_PARTITE.map(p => ({...p, type: 'partite'})),
                ...DB_HIGHLIGHTS.map(p => ({...p, type: 'highlights'})),
                ...DB_SHORTS.map(p => ({...p, type: 'shorts'}))
            ];
            const filtered = allDbsWithTypes.filter(p => p.titolo.toLowerCase().includes(val.toLowerCase()) || (p.cat || "").toLowerCase().includes(val.toLowerCase()));
            res.innerHTML = filtered.map(p => `<div class="search-result-item" onclick="openMatch('${p.id}', '${p.type}')"><img src="${p.img}" class="search-thumb"><div class="search-info"><b>${p.titolo}</b><div>${p.cat}</div></div></div>`).join('');
        }

        function animate() {
            const keys = ['home', 'cat', 'high'];
            keys.forEach(k => {
                const pageId = (k === 'high') ? 'highlights-page' : k;
                const p = document.getElementById(pageId);
                if(p && p.classList.contains('active-page')) {
                    const bar = document.getElementById(k + 'ProgressBar');
                    const slider = document.getElementById(k + 'Slider');
                    if(!bar || !slider) return;
                    let elapsed = Date.now() - sliders[k].start;
                    bar.style.width = Math.min((elapsed/5000)*100, 100) + "%";
                    if(elapsed >= 5000) {
                        const slides = slider.querySelectorAll('.slide');
                        if(slides.length > 1) { 
                            sliders[k].idx = (sliders[k].idx + 1) % slides.length; 
                            slider.style.transform = `translateX(-${sliders[k].idx*100}%)`; 
                        }
                        sliders[k].start = Date.now();
                    }
                }
            });
            requestAnimationFrame(animate);
        }

        initApp();
        animate();
        function toggleSearch() { const s = document.getElementById('search-bar-container'); s.style.display = s.style.display === 'block' ? 'none' : 'block'; if(s.style.display === 'block') document.getElementById('search-input').focus(); }
        function openNav() { document.getElementById("mySidebar").style.width = "280px"; }
        function closeNav() { document.getElementById("mySidebar").style.width = "0"; }
        function toggleDropdown(id) { const d = document.getElementById(id); d.style.display = d.style.display === "block" ? "none" : "block"; }
    </script>
</body>
</html>
